<Window x:Class="SevenPaint.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:SevenPaint"
        mc:Ignorable="d"
        Title="SevenPaint - Wintab &amp; Realtime Stylus Demo" Height="600" Width="800"
        Closing="MainWindow_Closing"
        KeyDown="Window_KeyDown"
        Focusable="True">
    <DockPanel>
        <Menu DockPanel.Dock="Top">
            <MenuItem Header="Input API">
                <MenuItem x:Name="MenuUseWintab" Header="Use Wintab" IsCheckable="True" Click="MenuUseWintab_Click"/>
            </MenuItem>
        </Menu>
        
        <!-- Ribbon UI -->
        <Border DockPanel.Dock="Top" BorderBrush="Gray" BorderThickness="0,0,0,1" Padding="5">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="10"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="10"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="10"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- SECTION 1: STROKE FORMAT -->
                <StackPanel Grid.Column="0">
                    <TextBlock Text="STROKE FORMAT" FontWeight="Bold" Margin="0,0,0,5"/>
                    <StackPanel Orientation="Horizontal" Margin="0,2">
                        <TextBlock Text="Size " VerticalAlignment="Center"/>
                        <ComboBox x:Name="ComboSize" Width="60" Padding="2,0,2,0" VerticalContentAlignment="Center" SelectedIndex="3" SelectionChanged="ComboSize_SelectionChanged">
                            <ComboBoxItem Content="1px"/>
                            <ComboBoxItem Content="5px"/>
                            <ComboBoxItem Content="10px"/>
                            <ComboBoxItem Content="50px"/>
                            <ComboBoxItem Content="100px"/>
                            <ComboBoxItem Content="300px"/>
                        </ComboBox>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,2">
                        <TextBlock Text="Scale size by " VerticalAlignment="Center"/>
                        <ComboBox x:Name="ComboScale" Width="100" Padding="2,0,2,0" VerticalContentAlignment="Center" SelectedIndex="1" SelectionChanged="ComboScale_SelectionChanged">
                            <ComboBoxItem Content="Don't scale"/>
                            <ComboBoxItem Content="Pressure"/>
                            <ComboBoxItem Content="Tilt Azimuth"/>
                            <ComboBoxItem Content="Tilt Altitude"/>
                            <ComboBoxItem Content="Barrel Rotation"/>
                        </ComboBox>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,2">
                        <TextBlock Text="Color " VerticalAlignment="Center"/>
                        <ComboBox x:Name="ComboColor" Width="80" Padding="2,0,2,0" VerticalContentAlignment="Center" SelectedIndex="0" SelectionChanged="ComboColor_SelectionChanged">
                            <ComboBoxItem Content="Black"/>
                            <ComboBoxItem Content="Red"/>
                            <ComboBoxItem Content="Green"/>
                            <ComboBoxItem Content="Blue"/>
                        </ComboBox>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,2">
                        <TextBlock Text="Min size " VerticalAlignment="Center"/>
                        <ComboBox Width="60" Padding="2,0,2,0" SelectedIndex="0">
                            <ComboBoxItem Content="1px"/>
                        </ComboBox>
                    </StackPanel>
                </StackPanel>

                <Rectangle Grid.Column="1" Width="1" Fill="LightGray" VerticalAlignment="Stretch"/>

                <!-- SECTION 2: POINTER -->
                <StackPanel Grid.Column="2" Width="120">
                    <TextBlock Text="POINTER" FontWeight="Bold" Margin="0,0,0,5"/>
                    <TextBlock x:Name="TxtButtons" Text="Buttons: 0 (none)"/>
                    <TextBlock x:Name="TxtX" Text="X: 0.0"/>
                    <TextBlock x:Name="TxtY" Text="Y: 0.0"/>
                    <TextBlock x:Name="TxtVelocity" Text="Velocity: 0.0 px/s"/>
                    <TextBlock x:Name="TxtDirection" Text="Direction: 0.0"/>
                </StackPanel>

                <Rectangle Grid.Column="3" Width="1" Fill="LightGray" VerticalAlignment="Stretch"/>

                <!-- SECTION 3: SENSORS -->
                <StackPanel Grid.Column="4" Width="120">
                    <TextBlock Text="SENSORS" FontWeight="Bold" Margin="0,0,0,5"/>
                    <TextBlock x:Name="TxtPressure" Text="Pressure: 0.0000"/>
                    <TextBlock x:Name="TxtTiltX" Text="Tilt x: 0.0"/>
                    <TextBlock x:Name="TxtTiltY" Text="Tilt y: 0.0"/>
                    <TextBlock x:Name="TxtTiltAzimuth" Text="Tilt azimuth: 0.0"/>
                    <TextBlock x:Name="TxtTiltAltitude" Text="Tilt altitude: 0.0"/>
                    <TextBlock x:Name="TxtBarrelRotation" Text="Barrel rotation: 0"/>
                </StackPanel>

                <Rectangle Grid.Column="5" Width="1" Fill="LightGray" VerticalAlignment="Stretch"/>

                <!-- SECTION 4: ACTIONS -->
                <StackPanel Grid.Column="6">
                    <TextBlock Text="ACTIONS" FontWeight="Bold" Margin="0,0,0,5"/>
                    <Button Content="Clear Canvas" Width="80" Height="25" HorizontalAlignment="Left" Click="ButtonClear_Click"/>
                </StackPanel>
            </Grid>
        </Border>
        <StatusBar DockPanel.Dock="Bottom">
            <TextBlock x:Name="StatusLabel" Text="Active API: Windows Ink"/>
        </StatusBar>
        <Grid>
            <Image x:Name="RenderImage" Stretch="None" 
                   StylusDown="RenderImage_StylusDown"
                   StylusMove="RenderImage_StylusMove"
                   StylusUp="RenderImage_StylusUp" 
                   Cursor="Pen"/>
        </Grid>
    </DockPanel>
</Window>
